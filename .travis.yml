# R for travis: see documentation at https://docs.travis-ci.com/user/languages/r

language: R
cache: packages

install:
- R -e 'install.packages("remotes")'
- R -e 'remotes::install_deps(dep = T)'
- R -e 'remotes::install_local()'
- Rscript install.R

script:
- Rscript -e 'testthat::test_dir("tests/testthat/", reporter = c("progress", "fail"))'

after_failure:
- Rscript py_install_test.R

matrix:
  include:
  - os: linux
    env: INSTALL_METHOD="conda" TENSORFLOW_VERSION="default"
  - os: linux
    env: INSTALL_METHOD="conda" TENSORFLOW_VERSION="nightly"
  - os: linux
    env: INSTALL_METHOD="conda" TENSORFLOW_VERSION="2.0.0-b0"
  - os: linux
    env: INSTALL_METHOD="virtualenv" TENSORFLOW_VERSION="default"
  - os: linux
    env: INSTALL_METHOD="virtualenv" TENSORFLOW_VERSION="nightly"
  - os: linux
    env: INSTALL_METHOD="virtualenv" TENSORFLOW_VERSION="2.0.0-b0"
  - os: linux
    INSTALL_METHOD="virtualenv" TENSORFLOW_VERSION="https://files.pythonhosted.org/packages/d2/ea/ab2c8c0e81bd051cc1180b104c75a865ab0fc66c89be992c4b20bbf6d624/tensorflow-1.13.1-cp27-cp27mu-manylinux1_x86_64.whl"
  - os: linux
    INSTALL_METHOD="conda" TENSORFLOW_VERSION="https://files.pythonhosted.org/packages/d4/29/6b4f1e02417c3a1ccc85380f093556ffd0b35dc354078074c5195c8447f2/tensorflow-1.13.1-cp37-cp37m-manylinux1_x86_64.whl"
  - os: osx
    env: INSTALL_METHOD="conda" TENSORFLOW_VERSION="default"
  - os: osx
    env: INSTALL_METHOD="conda" TENSORFLOW_VERSION="nightly"
  - os: osx
    env: INSTALL_METHOD="conda" TENSORFLOW_VERSION="2.0.0-b0"
  - os: osx
    env: INSTALL_METHOD="virtualenv" TENSORFLOW_VERSION="default"
  - os: osx
    env: INSTALL_METHOD="virtualenv" TENSORFLOW_VERSION="nightly"
  - os: osx
    env: INSTALL_METHOD="virtualenv" TENSORFLOW_VERSION="2.0.0-b0"
  - os: osx
    INSTALL_METHOD="virtualenv" TENSORFLOW_VERSION="https://files.pythonhosted.org/packages/89/33/8617196404b6bbdd7d8a4c4fad0a2b28c81cfdb63786ce70800778d8e72d/tensorflow-1.13.1-cp27-cp27m-macosx_10_11_x86_64.whl"
  - os: linux
    INSTALL_METHOD="conda" TENSORFLOW_VERSION="https://files.pythonhosted.org/packages/d5/1c/3ac472009a5c54ae7ec5a3294520ca36d1908cd1e5cf3e3fd923f9b7b31f/tensorflow-1.13.1-cp37-cp37m-macosx_10_11_x86_64.whl"

dist: xenial
